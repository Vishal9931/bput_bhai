<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Projects - TopManagement Dashboard</title>
    <link rel="stylesheet" href="../css/main.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script type="module" src="https://static.rocket.new/rocket-web.js?_cfg=https%3A%2F%2Ftopmanagem2294back.builtwithrocket.new&_be=https%3A%2F%2Fapplication.rocket.new&_v=0.1.9"></script>
  <script type="module" src="https://static.rocket.new/rocket-shot.js?v=0.0.1"></script>
  </head>
<body class="bg-background min-h-screen">
    <!-- Navigation Sidebar -->
    <div class="flex">
        <nav class="w-64 bg-surface shadow-lg min-h-screen fixed left-0 top-0 z-50">
            <div class="p-6">
                <!-- Logo -->
                <div class="flex items-center gap-3 mb-8">
                    <div class="w-10 h-10 bg-primary rounded-lg flex items-center justify-center">
                        <i class="fas fa-chart-line text-white text-lg"></i>
                    </div>
                    <div>
                        <h1 class="text-xl font-bold text-text-primary">TopManagement</h1>
                        <p class="text-sm text-text-secondary">Dashboard</p>
                    </div>
                </div>

                <!-- Navigation Links -->
                <ul class="space-y-2">
                    <li>
                        <a href="dashboard.html" class="flex items-center gap-3 px-4 py-3 text-text-secondary hover:bg-secondary-50 hover:text-text-primary rounded-lg transition-colors">
                            <i class="fas fa-tachometer-alt w-5"></i>
                            Dashboard
                        </a>
                    </li>
                    <li>
                        <a href="projects.html" class="flex items-center gap-3 px-4 py-3 bg-primary-50 text-primary rounded-lg font-medium">
                            <i class="fas fa-project-diagram w-5"></i>
                            Projects
                        </a>
                    </li>
                    <li>
                        <a href="employees.html" class="flex items-center gap-3 px-4 py-3 text-text-secondary hover:bg-secondary-50 hover:text-text-primary rounded-lg transition-colors">
                            <i class="fas fa-users w-5"></i>
                            Employees
                        </a>
                    </li>
                    <li>
                        <a href="reports.html" class="flex items-center gap-3 px-4 py-3 text-text-secondary hover:bg-secondary-50 hover:text-text-primary rounded-lg transition-colors">
                            <i class="fas fa-file-alt w-5"></i>
                            Reports
                        </a>
                    </li>
                    <li>
                        <a href="settings.html" class="flex items-center gap-3 px-4 py-3 text-text-secondary hover:bg-secondary-50 hover:text-text-primary rounded-lg transition-colors">
                            <i class="fas fa-cog w-5"></i>
                            Settings
                        </a>
                    </li>
                </ul>
            </div>

            <!-- User Profile -->
            <div class="absolute bottom-0 left-0 right-0 p-6 border-t border-secondary-200">
                <div class="flex items-center gap-3">
                    <img src="https://images.unsplash.com/photo-1580128636806-b29892ddbb48" 
                         alt="Executive profile photo" 
                         class="w-10 h-10 rounded-full object-cover"
                         onerror="this.src='https://images.unsplash.com/photo-1584824486509-112e4181ff6b?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D'; this.onerror=null;">
                    <div class="flex-1">
                        <p class="text-sm font-medium text-text-primary">John Executive</p>
                        <p class="text-xs text-text-secondary">CEO</p>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="flex-1 ml-64 p-8">
            <!-- Header -->
            <header class="mb-8">
                <div class="flex items-center justify-between">
                    <div>
                        <h1 class="text-3xl font-bold text-text-primary mb-2">Project Management</h1>
                        <p class="text-text-secondary">Monitor and manage projects across all industrial sectors</p>
                    </div>
                    <div class="flex items-center gap-4">
                        <div class="text-right">
                            <p class="text-sm text-text-secondary">Last Updated</p>
                            <p class="text-sm font-medium text-text-primary">Nov 02, 2025 - 03:43 AM</p>
                        </div>
                        <button class="p-2 text-text-secondary hover:text-text-primary hover:bg-secondary-50 rounded-lg transition-colors">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>
                </div>
            </header>

            <!-- Summary Cards -->
            <section class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                <!-- Total Projects -->
                <div class="card hover-lift">
                    <div class="flex items-center justify-between mb-4">
                        <div class="w-12 h-12 bg-primary-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-project-diagram text-primary text-xl"></i>
                        </div>
                        <div class="flex items-center gap-1 text-success-600 text-sm font-medium">
                            <i class="fas fa-arrow-up text-xs"></i>
                            +12%
                        </div>
                    </div>
                    <h3 class="text-2xl font-bold text-text-primary mb-1">47</h3>
                    <p class="text-text-secondary text-sm">Total Projects</p>
                </div>

                <!-- Active Projects -->
                <div class="card hover-lift">
                    <div class="flex items-center justify-between mb-4">
                        <div class="w-12 h-12 bg-success-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-play-circle text-success-600 text-xl"></i>
                        </div>
                        <div class="flex items-center gap-1 text-success-600 text-sm font-medium">
                            <i class="fas fa-arrow-up text-xs"></i>
                            +5%
                        </div>
                    </div>
                    <h3 class="text-2xl font-bold text-text-primary mb-1">32</h3>
                    <p class="text-text-secondary text-sm">Active Projects</p>
                </div>

                <!-- Completion Rate -->
                <div class="card hover-lift">
                    <div class="flex items-center justify-between mb-4">
                        <div class="w-12 h-12 bg-accent-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-chart-pie text-accent-600 text-xl"></i>
                        </div>
                        <div class="flex items-center gap-1 text-success-600 text-sm font-medium">
                            <i class="fas fa-arrow-up text-xs"></i>
                            +3%
                        </div>
                    </div>
                    <h3 class="text-2xl font-bold text-text-primary mb-1">87%</h3>
                    <p class="text-text-secondary text-sm">Completion Rate</p>
                </div>

                <!-- On Schedule -->
                <div class="card hover-lift">
                    <div class="flex items-center justify-between mb-4">
                        <div class="w-12 h-12 bg-warning-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-clock text-warning-600 text-xl"></i>
                        </div>
                        <div class="flex items-center gap-1 text-error-600 text-sm font-medium">
                            <i class="fas fa-arrow-down text-xs"></i>
                            -2%
                        </div>
                    </div>
                    <h3 class="text-2xl font-bold text-text-primary mb-1">28</h3>
                    <p class="text-text-secondary text-sm">On Schedule</p>
                </div>
            </section>

            <!-- Filters and Search -->
            <section class="card mb-8">
                <div class="flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between">
                    <div class="flex flex-wrap gap-4">
                        <!-- Search Input -->
                        <div class="relative">
                            <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-text-secondary"></i>
                            <input type="text" 
                                   id="projectSearch" 
                                   placeholder="Search projects..." 
                                   class="pl-10 pr-4 py-2 border border-secondary-200 rounded-lg focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary-100 w-64">
                        </div>

                        <!-- Status Filter -->
                        <select id="statusFilter" class="px-4 py-2 border border-secondary-200 rounded-lg focus:outline-none focus:border-primary">
                            <option value="">All Status</option>
                            <option value="active">Active</option>
                            <option value="completed">Completed</option>
                            <option value="delayed">Delayed</option>
                            <option value="on-hold">On Hold</option>
                        </select>

                        <!-- Timeline Filter -->
                        <select id="timelineFilter" class="px-4 py-2 border border-secondary-200 rounded-lg focus:outline-none focus:border-primary">
                            <option value="">All Timeline</option>
                            <option value="on-track">On Track</option>
                            <option value="at-risk">At Risk</option>
                            <option value="delayed">Delayed</option>
                        </select>
                    </div>

                    <div class="flex gap-2">
                        <button id="resetFilters" class="px-4 py-2 text-text-secondary hover:text-text-primary hover:bg-secondary-50 rounded-lg transition-colors">
                            <i class="fas fa-undo mr-2"></i>Reset
                        </button>
                        <button class="btn-primary">
                            <i class="fas fa-plus mr-2"></i>Add Project
                        </button>
                    </div>
                </div>
            </section>

            <!-- Sector Tabs -->
            <section class="card">
                <div class="border-b border-secondary-200 mb-6">
                    <nav class="flex space-x-8">
                        <button class="sector-tab active py-4 px-1 border-b-2 border-primary text-primary font-medium" data-sector="all">
                            All Sectors <span class="ml-2 px-2 py-1 bg-primary-100 text-primary rounded-full text-xs">47</span>
                        </button>
                        <button class="sector-tab py-4 px-1 border-b-2 border-transparent text-text-secondary hover:text-text-primary hover:border-secondary-300 font-medium" data-sector="infrastructure">
                            Infrastructure <span class="ml-2 px-2 py-1 bg-secondary-100 text-secondary-600 rounded-full text-xs">18</span>
                        </button>
                        <button class="sector-tab py-4 px-1 border-b-2 border-transparent text-text-secondary hover:text-text-primary hover:border-secondary-300 font-medium" data-sector="energy">
                            Energy <span class="ml-2 px-2 py-1 bg-secondary-100 text-secondary-600 rounded-full text-xs">15</span>
                        </button>
                        <button class="sector-tab py-4 px-1 border-b-2 border-transparent text-text-secondary hover:text-text-primary hover:border-secondary-300 font-medium" data-sector="oil-gas">
                            Oil & Gas <span class="ml-2 px-2 py-1 bg-secondary-100 text-secondary-600 rounded-full text-xs">14</span>
                        </button>
                    </nav>
                </div>

                <!-- Projects Table -->
                <div class="overflow-x-auto">
                    <table class="w-full data-table" id="projectsTable">
                        <thead>
                            <tr>
                                <th class="text-left cursor-pointer hover:bg-secondary-100" data-sort="name">
                                    Project Name <i class="fas fa-sort ml-1 text-xs"></i>
                                </th>
                                <th class="text-left cursor-pointer hover:bg-secondary-100" data-sort="sector">
                                    Sector <i class="fas fa-sort ml-1 text-xs"></i>
                                </th>
                                <th class="text-left cursor-pointer hover:bg-secondary-100" data-sort="status">
                                    Status <i class="fas fa-sort ml-1 text-xs"></i>
                                </th>
                                <th class="text-left cursor-pointer hover:bg-secondary-100" data-sort="safety-officer">
                                    Site Safety Officer <i class="fas fa-sort ml-1 text-xs"></i>
                                </th>
                                <th class="text-left cursor-pointer hover:bg-secondary-100" data-sort="ho-manager">
                                    HO Manager <i class="fas fa-sort ml-1 text-xs"></i>
                                </th>
                                <th class="text-left cursor-pointer hover:bg-secondary-100" data-sort="timeline">
                                    Timeline <i class="fas fa-sort ml-1 text-xs"></i>
                                </th>
                                <th class="text-left cursor-pointer hover:bg-secondary-100" data-sort="progress">
                                    Progress <i class="fas fa-sort ml-1 text-xs"></i>
                                </th>
                                <th class="text-left">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="projectsTableBody">
                            <!-- Project rows will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>

                <!-- Pagination -->
                <div class="flex items-center justify-between mt-6 pt-6 border-t border-secondary-200">
                    <div class="text-sm text-text-secondary">
                        Showing <span id="showingStart">1</span> to <span id="showingEnd">10</span> of <span id="totalProjects">47</span> projects
                    </div>
                    <div class="flex gap-2">
                        <button id="prevPage" class="px-3 py-2 text-text-secondary hover:text-text-primary hover:bg-secondary-50 rounded-lg transition-colors disabled:opacity-50" disabled>
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <button class="px-3 py-2 bg-primary text-white rounded-lg">1</button>
                        <button class="px-3 py-2 text-text-secondary hover:text-text-primary hover:bg-secondary-50 rounded-lg transition-colors">2</button>
                        <button class="px-3 py-2 text-text-secondary hover:text-text-primary hover:bg-secondary-50 rounded-lg transition-colors">3</button>
                        <button id="nextPage" class="px-3 py-2 text-text-secondary hover:text-text-primary hover:bg-secondary-50 rounded-lg transition-colors">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Project Detail Modal -->
    <div id="projectModal" class="modal-overlay">
        <div class="modal-content w-full max-w-4xl p-6">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-2xl font-bold text-text-primary" id="modalProjectName">Project Details</h2>
                <button id="closeModal" class="p-2 text-text-secondary hover:text-text-primary hover:bg-secondary-50 rounded-lg transition-colors">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <!-- Project Information -->
                <div class="space-y-4">
                    <div>
                        <h3 class="text-lg font-semibold text-text-primary mb-3">Project Information</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between">
                                <span class="text-text-secondary">Sector:</span>
                                <span class="font-medium text-text-primary" id="modalSector">Infrastructure</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-text-secondary">Status:</span>
                                <span class="status-indicator status-success" id="modalStatus">Active</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-text-secondary">Start Date:</span>
                                <span class="font-medium text-text-primary" id="modalStartDate">Jan 15, 2025</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-text-secondary">End Date:</span>
                                <span class="font-medium text-text-primary" id="modalEndDate">Dec 30, 2025</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-text-secondary">Budget:</span>
                                <span class="font-medium text-text-primary" id="modalBudget">$2.5M</span>
                            </div>
                        </div>
                    </div>

                    <!-- Team Assignment -->
                    <div>
                        <h3 class="text-lg font-semibold text-text-primary mb-3">Team Assignment</h3>
                        <div class="space-y-3">
                            <div class="flex items-center gap-3">
                                <img src="https://images.unsplash.com/photo-1596815121747-84d2667da88d" 
                                     alt="Site Safety Officer profile photo" 
                                     class="w-10 h-10 rounded-full object-cover"
                                     onerror="this.src='https://images.unsplash.com/photo-1584824486509-112e4181ff6b?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D'; this.onerror=null;">
                                <div>
                                    <p class="font-medium text-text-primary" id="modalSafetyOfficer">Sarah Johnson</p>
                                    <p class="text-sm text-text-secondary">Site Safety Officer</p>
                                </div>
                            </div>
                            <div class="flex items-center gap-3">
                                <img src="https://images.unsplash.com/photo-1498200705497-2c9e717e5ab8" 
                                     alt="HO Manager profile photo" 
                                     class="w-10 h-10 rounded-full object-cover"
                                     onerror="this.src='https://images.unsplash.com/photo-1584824486509-112e4181ff6b?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D'; this.onerror=null;">
                                <div>
                                    <p class="font-medium text-text-primary" id="modalHOManager">Michael Chen</p>
                                    <p class="text-sm text-text-secondary">HO Manager</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Progress and Safety Metrics -->
                <div class="space-y-4">
                    <div>
                        <h3 class="text-lg font-semibold text-text-primary mb-3">Progress Overview</h3>
                        <div class="space-y-4">
                            <div>
                                <div class="flex justify-between mb-2">
                                    <span class="text-text-secondary">Overall Progress</span>
                                    <span class="font-medium text-text-primary" id="modalProgress">75%</span>
                                </div>
                                <div class="w-full bg-secondary-200 rounded-full h-3">
                                    <div class="bg-primary h-3 rounded-full" id="modalProgressBar" style="width: 75%"></div>
                                </div>
                            </div>
                            <div>
                                <div class="flex justify-between mb-2">
                                    <span class="text-text-secondary">Safety Score</span>
                                    <span class="font-medium text-text-primary">94%</span>
                                </div>
                                <div class="w-full bg-secondary-200 rounded-full h-3">
                                    <div class="bg-success-500 h-3 rounded-full" style="width: 94%"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Safety Metrics -->
                    <div>
                        <h3 class="text-lg font-semibold text-text-primary mb-3">Safety Metrics</h3>
                        <div class="grid grid-cols-2 gap-4">
                            <div class="text-center p-3 bg-success-50 rounded-lg">
                                <div class="text-2xl font-bold text-success-600">0</div>
                                <div class="text-sm text-text-secondary">Incidents</div>
                            </div>
                            <div class="text-center p-3 bg-warning-50 rounded-lg">
                                <div class="text-2xl font-bold text-warning-600">3</div>
                                <div class="text-sm text-text-secondary">Near Miss</div>
                            </div>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="flex gap-3 pt-4">
                        <button class="btn-primary flex-1">
                            <i class="fas fa-edit mr-2"></i>Edit Project
                        </button>
                        <button class="btn-secondary">
                            <i class="fas fa-download mr-2"></i>Report
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Mock project data
        const projectsData = [
            {
                id: 1,
                name: "Metro Rail Phase 3",
                sector: "infrastructure",
                status: "active",
                safetyOfficer: "Sarah Johnson",
                hoManager: "Michael Chen",
                timeline: "on-track",
                progress: 75,
                startDate: "Jan 15, 2025",
                endDate: "Dec 30, 2025",
                budget: "$2.5M",
                safetyScore: 94,
                incidents: 0,
                nearMiss: 3
            },
            {
                id: 2,
                name: "Highway Bridge Construction",
                sector: "infrastructure",
                status: "active",
                safetyOfficer: "David Wilson",
                hoManager: "Lisa Anderson",
                timeline: "at-risk",
                progress: 45,
                startDate: "Mar 01, 2025",
                endDate: "Nov 15, 2025",
                budget: "$1.8M",
                safetyScore: 87,
                incidents: 1,
                nearMiss: 5
            },
            {
                id: 3,
                name: "Wind Farm Delta",
                sector: "energy",
                status: "active",
                safetyOfficer: "Emma Thompson",
                hoManager: "Robert Kim",
                timeline: "on-track",
                progress: 85,
                startDate: "Feb 10, 2025",
                endDate: "Oct 20, 2025",
                budget: "$3.2M",
                safetyScore: 96,
                incidents: 0,
                nearMiss: 2
            },
            {
                id: 4,
                name: "Solar Plant Expansion",
                sector: "energy",
                status: "completed",
                safetyOfficer: "James Rodriguez",
                hoManager: "Maria Garcia",
                timeline: "completed",
                progress: 100,
                startDate: "Jan 05, 2025",
                endDate: "Aug 30, 2025",
                budget: "$2.1M",
                safetyScore: 98,
                incidents: 0,
                nearMiss: 1
            },
            {
                id: 5,
                name: "Offshore Platform Alpha",
                sector: "oil-gas",
                status: "active",
                safetyOfficer: "Thomas Lee",
                hoManager: "Jennifer White",
                timeline: "delayed",
                progress: 60,
                startDate: "Apr 01, 2025",
                endDate: "Dec 15, 2025",
                budget: "$4.5M",
                safetyScore: 89,
                incidents: 2,
                nearMiss: 8
            },
            {
                id: 6,
                name: "Pipeline Maintenance",
                sector: "oil-gas",
                status: "active",
                safetyOfficer: "Amanda Davis",
                hoManager: "Christopher Brown",
                timeline: "on-track",
                progress: 30,
                startDate: "May 15, 2025",
                endDate: "Jan 30, 2026",
                budget: "$1.9M",
                safetyScore: 92,
                incidents: 0,
                nearMiss: 4
            },
            {
                id: 7,
                name: "Urban Development Complex",
                sector: "infrastructure",
                status: "active",
                safetyOfficer: "Kevin Martinez",
                hoManager: "Rachel Taylor",
                timeline: "on-track",
                progress: 55,
                startDate: "Jun 01, 2025",
                endDate: "Mar 15, 2026",
                budget: "$5.8M",
                safetyScore: 91,
                incidents: 1,
                nearMiss: 6
            },
            {
                id: 8,
                name: "Hydroelectric Dam",
                sector: "energy",
                status: "active",
                safetyOfficer: "Nicole Johnson",
                hoManager: "Daniel Wilson",
                timeline: "at-risk",
                progress: 40,
                startDate: "Jul 10, 2025",
                endDate: "Jun 30, 2026",
                budget: "$7.2M",
                safetyScore: 85,
                incidents: 3,
                nearMiss: 12
            }
        ];

        let currentSector = 'all';
        let currentPage = 1;
        const itemsPerPage = 10;
        let filteredProjects = [...projectsData];

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            renderProjects();
            setupEventListeners();
        });

        function setupEventListeners() {
            // Sector tabs
            document.querySelectorAll('.sector-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    currentSector = this.dataset.sector;
                    updateActiveTab(this);
                    filterProjects();
                });
            });

            // Search functionality
            document.getElementById('projectSearch').addEventListener('input', filterProjects);
            document.getElementById('statusFilter').addEventListener('change', filterProjects);
            document.getElementById('timelineFilter').addEventListener('change', filterProjects);

            // Reset filters
            document.getElementById('resetFilters').addEventListener('click', resetFilters);

            // Modal functionality
            document.getElementById('closeModal').addEventListener('click', closeModal);
            document.getElementById('projectModal').addEventListener('click', function(e) {
                if (e.target === this) closeModal();
            });

            // Table sorting
            document.querySelectorAll('[data-sort]').forEach(header => {
                header.addEventListener('click', function() {
                    sortProjects(this.dataset.sort);
                });
            });
        }

        function updateActiveTab(activeTab) {
            document.querySelectorAll('.sector-tab').forEach(tab => {
                tab.classList.remove('active', 'border-primary', 'text-primary');
                tab.classList.add('border-transparent', 'text-text-secondary');
            });
            activeTab.classList.add('active', 'border-primary', 'text-primary');
            activeTab.classList.remove('border-transparent', 'text-text-secondary');
        }

        function filterProjects() {
            const searchTerm = document.getElementById('projectSearch').value.toLowerCase();
            const statusFilter = document.getElementById('statusFilter').value;
            const timelineFilter = document.getElementById('timelineFilter').value;

            filteredProjects = projectsData.filter(project => {
                const matchesSector = currentSector === 'all' || project.sector === currentSector;
                const matchesSearch = project.name.toLowerCase().includes(searchTerm) ||
                                    project.safetyOfficer.toLowerCase().includes(searchTerm) ||
                                    project.hoManager.toLowerCase().includes(searchTerm);
                const matchesStatus = !statusFilter || project.status === statusFilter;
                const matchesTimeline = !timelineFilter || project.timeline === timelineFilter;

                return matchesSector && matchesSearch && matchesStatus && matchesTimeline;
            });

            currentPage = 1;
            renderProjects();
            updatePagination();
        }

        function resetFilters() {
            document.getElementById('projectSearch').value = '';
            document.getElementById('statusFilter').value = '';
            document.getElementById('timelineFilter').value = '';
            currentSector = 'all';
            
            // Reset active tab
            document.querySelectorAll('.sector-tab').forEach(tab => {
                tab.classList.remove('active', 'border-primary', 'text-primary');
                tab.classList.add('border-transparent', 'text-text-secondary');
            });
            document.querySelector('[data-sector="all"]').classList.add('active', 'border-primary', 'text-primary');
            document.querySelector('[data-sector="all"]').classList.remove('border-transparent', 'text-text-secondary');

            filteredProjects = [...projectsData];
            renderProjects();
            updatePagination();
        }

        function renderProjects() {
            const tbody = document.getElementById('projectsTableBody');
            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const projectsToShow = filteredProjects.slice(startIndex, endIndex);

            tbody.innerHTML = projectsToShow.map(project => `
                <tr class="hover:bg-secondary-50 cursor-pointer" onclick="openProjectModal(${project.id})">
                    <td class="font-medium text-text-primary">${project.name}</td>
                    <td>
                        <span class="px-2 py-1 rounded-full text-xs font-medium ${getSectorBadgeClass(project.sector)}">
                            ${formatSector(project.sector)}
                        </span>
                    </td>
                    <td>
                        <span class="status-indicator ${getStatusClass(project.status)}">
                            <i class="fas ${getStatusIcon(project.status)} text-xs"></i>
                            ${formatStatus(project.status)}
                        </span>
                    </td>
                    <td class="text-text-primary">${project.safetyOfficer}</td>
                    <td class="text-text-primary">${project.hoManager}</td>
                    <td>
                        <span class="px-2 py-1 rounded-full text-xs font-medium ${getTimelineBadgeClass(project.timeline)}">
                            ${formatTimeline(project.timeline)}
                        </span>
                    </td>
                    <td>
                        <div class="flex items-center gap-2">
                            <div class="flex-1 bg-secondary-200 rounded-full h-2">
                                <div class="bg-primary h-2 rounded-full" style="width: ${project.progress}%"></div>
                            </div>
                            <span class="text-sm font-medium text-text-primary">${project.progress}%</span>
                        </div>
                    </td>
                    <td>
                        <div class="flex gap-2">
                            <button class="p-1 text-text-secondary hover:text-primary hover:bg-primary-50 rounded transition-colors" onclick="event.stopPropagation(); openProjectModal(${project.id})">
                                <i class="fas fa-eye text-sm"></i>
                            </button>
                            <button class="p-1 text-text-secondary hover:text-accent-600 hover:bg-accent-50 rounded transition-colors" onclick="event.stopPropagation(); editProject(${project.id})">
                                <i class="fas fa-edit text-sm"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        function updatePagination() {
            document.getElementById('showingStart').textContent = Math.min((currentPage - 1) * itemsPerPage + 1, filteredProjects.length);
            document.getElementById('showingEnd').textContent = Math.min(currentPage * itemsPerPage, filteredProjects.length);
            document.getElementById('totalProjects').textContent = filteredProjects.length;
        }

        function openProjectModal(projectId) {
            const project = projectsData.find(p => p.id === projectId);
            if (!project) return;

            document.getElementById('modalProjectName').textContent = project.name;
            document.getElementById('modalSector').textContent = formatSector(project.sector);
            document.getElementById('modalStatus').textContent = formatStatus(project.status);
            document.getElementById('modalStatus').className = `status-indicator ${getStatusClass(project.status)}`;
            document.getElementById('modalStartDate').textContent = project.startDate;
            document.getElementById('modalEndDate').textContent = project.endDate;
            document.getElementById('modalBudget').textContent = project.budget;
            document.getElementById('modalSafetyOfficer').textContent = project.safetyOfficer;
            document.getElementById('modalHOManager').textContent = project.hoManager;
            document.getElementById('modalProgress').textContent = `${project.progress}%`;
            document.getElementById('modalProgressBar').style.width = `${project.progress}%`;

            document.getElementById('projectModal').classList.add('open');
        }

        function closeModal() {
            document.getElementById('projectModal').classList.remove('open');
        }

        function editProject(projectId) {
            // Placeholder for edit functionality
            console.log('Edit project:', projectId);
        }

        function sortProjects(column) {
            // Placeholder for sorting functionality
            console.log('Sort by:', column);
        }

        // Utility functions
        function getSectorBadgeClass(sector) {
            const classes = {
                'infrastructure': 'bg-primary-50 text-primary',
                'energy': 'bg-accent-50 text-accent-600',
                'oil-gas': 'bg-secondary-100 text-secondary-600'
            };
            return classes[sector] || 'bg-secondary-100 text-secondary-600';
        }

        function formatSector(sector) {
            const formats = {
                'infrastructure': 'Infrastructure',
                'energy': 'Energy',
                'oil-gas': 'Oil & Gas'
            };
            return formats[sector] || sector;
        }

        function getStatusClass(status) {
            const classes = {
                'active': 'status-success',
                'completed': 'status-success',
                'delayed': 'status-error',
                'on-hold': 'status-warning'
            };
            return classes[status] || 'status-warning';
        }

        function getStatusIcon(status) {
            const icons = {
                'active': 'fa-play-circle',
                'completed': 'fa-check-circle',
                'delayed': 'fa-exclamation-circle',
                'on-hold': 'fa-pause-circle'
            };
            return icons[status] || 'fa-circle';
        }

        function formatStatus(status) {
            const formats = {
                'active': 'Active',
                'completed': 'Completed',
                'delayed': 'Delayed',
                'on-hold': 'On Hold'
            };
            return formats[status] || status;
        }

        function getTimelineBadgeClass(timeline) {
            const classes = {
                'on-track': 'bg-success-50 text-success-600',
                'at-risk': 'bg-warning-50 text-warning-600',
                'delayed': 'bg-error-50 text-error-600',
                'completed': 'bg-success-50 text-success-600'
            };
            return classes[timeline] || 'bg-secondary-100 text-secondary-600';
        }

        function formatTimeline(timeline) {
            const formats = {
                'on-track': 'On Track',
                'at-risk': 'At Risk',
                'delayed': 'Delayed',
                'completed': 'Completed'
            };
            return formats[timeline] || timeline;
        }
    </script>
<script id="dhws-dataInjector" src="../public/dhws-data-injector.js"></script>
</body>
</html>