<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comparison Analysis - HO Safety Management</title>
    <link rel="stylesheet" href="../css2/main.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <script type="module" src="https://static.rocket.new/rocket-web.js?_cfg=https%3A%2F%2Fhosafety1834back.builtwithrocket.new&_be=https%3A%2F%2Fapplication.rocket.new&_v=0.1.9"></script>
  <script type="module" src="https://static.rocket.new/rocket-shot.js?v=0.0.1"></script>
  <style>
    /* Additional styles for enhanced UI */
    :root {
      --primary: #3b82f6;
      --primary-50: #eff6ff;
      --primary-100: #dbeafe;
      --primary-600: #2563eb;
      --primary-700: #1d4ed8;
      --success: #10b981;
      --success-100: #d1fae5;
      --success-600: #059669;
      --warning: #f59e0b;
      --warning-100: #fef3c7;
      --warning-600: #d97706;
      --error: #ef4444;
      --error-100: #fee2e2;
      --accent: #8b5cf6;
      --accent-100: #ede9fe;
      --accent-600: #7c3aed;
      --surface: #ffffff;
      --background: #f8fafc;
      --secondary-50: #f8fafc;
      --secondary-100: #f1f5f9;
      --secondary-200: #e2e8f0;
      --secondary-300: #cbd5e1;
      --text-primary: #1e293b;
      --text-secondary: #64748b;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background-color: var(--background);
      color: var(--text-primary);
    }

    .shadow-card {
      box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
    }

    .rounded-card {
      border-radius: 0.5rem;
    }

    .rounded-button {
      border-radius: 0.375rem;
    }

    .form-input {
      border: 1px solid var(--secondary-300);
      border-radius: 0.375rem;
      background-color: var(--surface);
      transition: all 0.2s;
    }

    .form-input:focus {
      outline: none;
      ring: 2px solid var(--primary-100);
      border-color: var(--primary);
    }

    .card-elevated {
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    }

    .status-indicator {
      width: 6px;
      height: 6px;
      border-radius: 50%;
    }

    .status-success {
      background-color: var(--success);
    }

    .status-warning {
      background-color: var(--warning);
    }

    .status-error {
      background-color: var(--error);
    }

    .status-accent {
      background-color: var(--accent);
    }

    .status-secondary {
      background-color: var(--secondary-300);
    }

    .animate-pulse {
      animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
    }

    @keyframes pulse {
      0%, 100% {
        opacity: 1;
      }
      50% {
        opacity: .5;
      }
    }

    .filter-chip {
      padding: 0.5rem 1rem;
      background-color: var(--secondary-100);
      color: var(--text-secondary);
      border-radius: 1.5rem;
      font-size: 0.875rem;
      transition: all 0.2s;
      border: none;
      cursor: pointer;
    }

    .filter-chip.active {
      background-color: var(--primary);
      color: white;
    }

    .filter-chip:hover:not(.active) {
      background-color: var(--secondary-200);
    }
  </style>
  </head>
<body class="bg-background font-inter">
    <!-- Navigation Header -->
    <nav class="bg-surface shadow-card border-b border-secondary-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <!-- Logo and Brand -->
                <div class="flex items-center space-x-4">
                    <div class="flex-shrink-0">
                        <svg class="h-8 w-8 text-primary" viewBox="0 0 32 32" fill="currentColor">
                            <path d="M16 2L3 7v10c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V7l-13-5z"/>
                            <path d="M14 16l-2-2-1.41 1.41L14 18.83l6-6L18.59 11.41 14 16z" fill="white"/>
                        </svg>
                    </div>
                    <div>
                        <h1 class="text-xl font-semibold text-text-primary">HO Safety Management</h1>
                        <p class="text-sm text-text-secondary">Comparison Analysis</p>
                    </div>
                </div>

                <!-- Navigation Links -->
                <div class="hidden md:flex items-center space-x-6">
                    <a href="dashboard_overview.html" class="text-text-secondary hover:text-primary transition-colors">Dashboard</a>
                    <a href="sector_view.html" class="text-text-secondary hover:text-primary transition-colors">Sectors</a>
                    <a href="project_overview.html" class="text-text-secondary hover:text-primary transition-colors">Projects</a>
                    <a href="site_safety_officer_detail.html" class="text-text-secondary hover:text-primary transition-colors">Officers</a>
                    <a href="comparison_analysis.html" class="text-primary font-medium border-b-2 border-primary pb-1">Analysis</a>
                    <a href="settings_access_control.html" class="text-text-secondary hover:text-primary transition-colors">Settings</a>
                </div>

                <!-- User Profile -->
                <div class="flex items-center space-x-4">
                    <button class="relative p-2 text-text-secondary hover:text-primary transition-colors">
                        <i class="fas fa-bell text-lg"></i>
                        <span class="absolute -top-1 -right-1 h-4 w-4 bg-error text-white text-xs rounded-full flex items-center justify-center">3</span>
                    </button>
                    <div class="flex items-center space-x-2">
                        <img src="https://images.unsplash.com/photo-1599182002081-60947de0356b" 
                             alt="Profile picture of John Smith, Head Office Manager" 
                             class="h-8 w-8 rounded-full object-cover"
                             onerror="this.src='https://images.unsplash.com/photo-1584824486509-112e4181ff6b?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D'; this.onerror=null;">
                        <span class="text-sm font-medium text-text-primary">John Smith</span>
                    </div>
                </div>

                <!-- Mobile Menu Button -->
                <div class="md:hidden">
                    <button id="mobile-menu-button" class="text-text-secondary hover:text-primary">
                        <i class="fas fa-bars text-lg"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden md:hidden bg-surface border-t border-secondary-200">
            <div class="px-4 py-2 space-y-2">
                <a href="dashboard_overview.html" class="block px-3 py-2 text-text-secondary hover:bg-secondary-50 rounded">Dashboard</a>
                <a href="sector_view.html" class="block px-3 py-2 text-text-secondary hover:bg-secondary-50 rounded">Sectors</a>
                <a href="project_overview.html" class="block px-3 py-2 text-text-secondary hover:bg-secondary-50 rounded">Projects</a>
                <a href="site_safety_officer_detail.html" class="block px-3 py-2 text-text-secondary hover:bg-secondary-50 rounded">Officers</a>
                <a href="comparison_analysis.html" class="block px-3 py-2 text-primary font-medium bg-primary-50 rounded">Analysis</a>
                <a href="settings_access_control.html" class="block px-3 py-2 text-text-secondary hover:bg-secondary-50 rounded">Settings</a>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
        <!-- Header Section -->
        <div class="flex flex-col lg:flex-row justify-between items-start lg:items-center mb-6 gap-4">
            <div>
                <h2 class="text-2xl font-bold text-text-primary">Comparative Analysis Dashboard</h2>
                <p class="text-text-secondary mt-1">Side-by-side data analysis for informed decision-making</p>
                <div class="flex items-center mt-2 text-sm text-text-secondary">
                    <i class="fas fa-clock mr-2"></i>
                    <span id="last-updated">Last updated: November 1, 2025 at 2:51 PM</span>
                    <div class="ml-4 flex items-center">
                        <div class="w-2 h-2 bg-success rounded-full animate-pulse mr-2"></div>
                        <span>Live</span>
                    </div>
                </div>
            </div>
            <div class="flex items-center space-x-3">
                <button id="export-excel-btn" class="flex items-center px-4 py-2 bg-success text-white rounded-button hover:bg-success-600 transition-colors">
                    <i class="fas fa-file-excel mr-2"></i>
                    Export Excel
                </button>
                <button id="export-pdf-btn" class="flex items-center px-4 py-2 bg-error text-white rounded-button hover:bg-error-600 transition-colors">
                    <i class="fas fa-file-pdf mr-2"></i>
                    Export PDF
                </button>
            </div>
        </div>

        <!-- Comparison Controls -->
        <div class="bg-surface rounded-card shadow-card p-6 mb-6">
            <div class="grid grid-cols-1 lg:grid-cols-4 gap-4">
                <!-- Comparison Type -->
                <div>
                    <label class="block text-sm font-medium text-text-primary mb-2">Comparison Type</label>
                    <select id="comparison-type" class="form-input w-full px-3 py-2">
                        <option value="sector">Sector vs Sector</option>
                        <option value="project">Project vs Project</option>
                        <option value="officer">Officer vs Officer</option>
                    </select>
                </div>

                <!-- First Entity -->
                <div>
                    <label class="block text-sm font-medium text-text-primary mb-2">First Entity</label>
                    <select id="first-entity" class="form-input w-full px-3 py-2">
                        <option value="construction">Construction Sector</option>
                        <option value="manufacturing">Manufacturing Sector</option>
                        <option value="energy">Energy Sector</option>
                        <option value="infrastructure">Infrastructure Sector</option>
                    </select>
                </div>

                <!-- Second Entity -->
                <div>
                    <label class="block text-sm font-medium text-text-primary mb-2">Second Entity</label>
                    <select id="second-entity" class="form-input w-full px-3 py-2">
                        <option value="manufacturing">Manufacturing Sector</option>
                        <option value="construction">Construction Sector</option>
                        <option value="energy">Energy Sector</option>
                        <option value="infrastructure">Infrastructure Sector</option>
                    </select>
                </div>

                <!-- Date Range -->
                <div>
                    <label class="block text-sm font-medium text-text-primary mb-2">Date Range</label>
                    <select class="form-input w-full px-3 py-2">
                        <option>Last 30 days</option>
                        <option>Last 90 days</option>
                        <option>Last 6 months</option>
                        <option>Last year</option>
                        <option>Custom range</option>
                    </select>
                </div>
            </div>

            <!-- Advanced Filters -->
            <div class="mt-4 pt-4 border-t border-secondary-200">
                <div class="flex flex-wrap items-center gap-4">
                    <div class="flex items-center space-x-2">
                        <i class="fas fa-filter text-text-secondary"></i>
                        <span class="text-sm font-medium text-text-primary">Advanced Filters:</span>
                    </div>
                    <div class="flex flex-wrap gap-2">
                        <button class="filter-chip active" data-filter="all">All Metrics</button>
                        <button class="filter-chip" data-filter="safety">Safety Scores</button>
                        <button class="filter-chip" data-filter="incidents">Incidents</button>
                        <button class="filter-chip" data-filter="compliance">Compliance</button>
                        <button class="filter-chip" data-filter="observations">Observations</button>
                    </div>
                    <button id="apply-comparison" class="ml-auto px-4 py-2 bg-primary text-white rounded-button hover:bg-primary-700 transition-colors">
                        <i class="fas fa-sync-alt mr-2"></i>
                        Apply Comparison
                    </button>
                </div>
            </div>
        </div>

        <!-- Dual Panel Comparison Layout -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
            <!-- Left Panel - Construction Sector -->
            <div class="card-elevated bg-surface">
                <!-- Panel Header -->
                <div class="p-6 border-b border-secondary-200">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-3">
                            <div class="w-12 h-12 bg-primary-100 rounded-lg flex items-center justify-center">
                                <i class="fas fa-hard-hat text-primary text-xl"></i>
                            </div>
                            <div>
                                <h3 class="text-lg font-semibold text-text-primary">Construction Sector</h3>
                                <p class="text-sm text-text-secondary">12 Active Projects • 24 Officers</p>
                            </div>
                        </div>
                        <div class="status-indicator status-success"></div>
                    </div>
                </div>

                <!-- Key Metrics -->
                <div class="p-6">
                    <div class="grid grid-cols-2 gap-4 mb-6">
                        <div class="text-center p-4 bg-success-50 rounded-lg">
                            <div class="text-2xl font-bold text-success mb-1">94.2%</div>
                            <div class="text-sm text-text-secondary">Safety Score</div>
                        </div>
                        <div class="text-center p-4 bg-primary-50 rounded-lg">
                            <div class="text-2xl font-bold text-primary mb-1">18</div>
                            <div class="text-sm text-text-secondary">Reports Today</div>
                        </div>
                        <div class="text-center p-4 bg-warning-50 rounded-lg">
                            <div class="text-2xl font-bold text-warning mb-1">3</div>
                            <div class="text-sm text-text-secondary">Open Incidents</div>
                        </div>
                        <div class="text-center p-4 bg-accent-50 rounded-lg">
                            <div class="text-2xl font-bold text-accent mb-1">1,247</div>
                            <div class="text-sm text-text-secondary">Observations</div>
                        </div>
                    </div>

                    <!-- Detailed Metrics Table -->
                    <div class="space-y-3">
                        <div class="flex justify-between items-center py-2 border-b border-secondary-100">
                            <span class="text-sm text-text-secondary">Compliance Rate</span>
                            <span class="font-semibold text-success">94.2%</span>
                        </div>
                        <div class="flex justify-between items-center py-2 border-b border-secondary-100">
                            <span class="text-sm text-text-secondary">Incident Rate (per 1000)</span>
                            <span class="font-semibold text-text-primary">2.4</span>
                        </div>
                        <div class="flex justify-between items-center py-2 border-b border-secondary-100">
                            <span class="text-sm text-text-secondary">Near Miss Reports</span>
                            <span class="font-semibold text-text-primary">156</span>
                        </div>
                        <div class="flex justify-between items-center py-2 border-b border-secondary-100">
                            <span class="text-sm text-text-secondary">Training Completion</span>
                            <span class="font-semibold text-success">98.5%</span>
                        </div>
                        <div class="flex justify-between items-center py-2">
                            <span class="text-sm text-text-secondary">Avg Response Time</span>
                            <span class="font-semibold text-text-primary">12 min</span>
                        </div>
                    </div>
                </div>

                <!-- Trend Chart -->
                <div class="p-6 border-t border-secondary-200">
                    <h4 class="text-sm font-medium text-text-primary mb-3">30-Day Trend</h4>
                    <div class="h-32 bg-secondary-50 rounded-lg flex items-center justify-center">
                        <svg class="w-full h-full" viewBox="0 0 300 120">
                            <polyline fill="none" stroke="#3B82F6" stroke-width="2" 
                                      points="20,80 50,70 80,75 110,65 140,60 170,55 200,50 230,45 260,40 290,35"/>
                            <circle cx="290" cy="35" r="3" fill="#3B82F6"/>
                        </svg>
                    </div>
                    <div class="flex items-center justify-between mt-2 text-xs text-text-secondary">
                        <span>Oct 1</span>
                        <span class="flex items-center text-success">
                            <i class="fas fa-arrow-up mr-1"></i>
                            +2.1% improvement
                        </span>
                        <span>Nov 1</span>
                    </div>
                </div>
            </div>

            <!-- Right Panel - Manufacturing Sector -->
            <div class="card-elevated bg-surface">
                <!-- Panel Header -->
                <div class="p-6 border-b border-secondary-200">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-3">
                            <div class="w-12 h-12 bg-accent-100 rounded-lg flex items-center justify-center">
                                <i class="fas fa-industry text-accent text-xl"></i>
                            </div>
                            <div>
                                <h3 class="text-lg font-semibold text-text-primary">Manufacturing Sector</h3>
                                <p class="text-sm text-text-secondary">8 Active Projects • 16 Officers</p>
                            </div>
                        </div>
                        <div class="status-indicator status-warning"></div>
                    </div>
                </div>

                <!-- Key Metrics -->
                <div class="p-6">
                    <div class="grid grid-cols-2 gap-4 mb-6">
                        <div class="text-center p-4 bg-warning-50 rounded-lg">
                            <div class="text-2xl font-bold text-warning mb-1">87.5%</div>
                            <div class="text-sm text-text-secondary">Safety Score</div>
                        </div>
                        <div class="text-center p-4 bg-primary-50 rounded-lg">
                            <div class="text-2xl font-bold text-primary mb-1">12</div>
                            <div class="text-sm text-text-secondary">Reports Today</div>
                        </div>
                        <div class="text-center p-4 bg-error-50 rounded-lg">
                            <div class="text-2xl font-bold text-error mb-1">7</div>
                            <div class="text-sm text-text-secondary">Open Incidents</div>
                        </div>
                        <div class="text-center p-4 bg-accent-50 rounded-lg">
                            <div class="text-2xl font-bold text-accent mb-1">892</div>
                            <div class="text-sm text-text-secondary">Observations</div>
                        </div>
                    </div>

                    <!-- Detailed Metrics Table -->
                    <div class="space-y-3">
                        <div class="flex justify-between items-center py-2 border-b border-secondary-100">
                            <span class="text-sm text-text-secondary">Compliance Rate</span>
                            <div class="flex items-center space-x-2">
                                <span class="font-semibold text-warning">87.5%</span>
                                <span class="text-xs text-error">(-6.7%)</span>
                            </div>
                        </div>
                        <div class="flex justify-between items-center py-2 border-b border-secondary-100">
                            <span class="text-sm text-text-secondary">Incident Rate (per 1000)</span>
                            <div class="flex items-center space-x-2">
                                <span class="font-semibold text-text-primary">4.1</span>
                                <span class="text-xs text-error">(+70.8%)</span>
                            </div>
                        </div>
                        <div class="flex justify-between items-center py-2 border-b border-secondary-100">
                            <span class="text-sm text-text-secondary">Near Miss Reports</span>
                            <div class="flex items-center space-x-2">
                                <span class="font-semibold text-text-primary">89</span>
                                <span class="text-xs text-error">(-42.9%)</span>
                            </div>
                        </div>
                        <div class="flex justify-between items-center py-2 border-b border-secondary-100">
                            <span class="text-sm text-text-secondary">Training Completion</span>
                            <div class="flex items-center space-x-2">
                                <span class="font-semibold text-warning">91.2%</span>
                                <span class="text-xs text-error">(-7.4%)</span>
                            </div>
                        </div>
                        <div class="flex justify-between items-center py-2">
                            <span class="text-sm text-text-secondary">Avg Response Time</span>
                            <div class="flex items-center space-x-2">
                                <span class="font-semibold text-text-primary">18 min</span>
                                <span class="text-xs text-error">(+50.0%)</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Trend Chart -->
                <div class="p-6 border-t border-secondary-200">
                    <h4 class="text-sm font-medium text-text-primary mb-3">30-Day Trend</h4>
                    <div class="h-32 bg-secondary-50 rounded-lg flex items-center justify-center">
                        <svg class="w-full h-full" viewBox="0 0 300 120">
                            <polyline fill="none" stroke="#0EA5E9" stroke-width="2" 
                                      points="20,60 50,65 80,70 110,75 140,80 170,85 200,90 230,85 260,80 290,75"/>
                            <circle cx="290" cy="75" r="3" fill="#0EA5E9"/>
                        </svg>
                    </div>
                    <div class="flex items-center justify-between mt-2 text-xs text-text-secondary">
                        <span>Oct 1</span>
                        <span class="flex items-center text-error">
                            <i class="fas fa-arrow-down mr-1"></i>
                            -1.3% decline
                        </span>
                        <span>Nov 1</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Visualization Options -->
        <div class="bg-surface rounded-card shadow-card p-6 mb-6">
            <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4">
                <div>
                    <h3 class="text-lg font-semibold text-text-primary">Interactive Visualization</h3>
                    <p class="text-sm text-text-secondary mt-1">Choose visualization type for detailed comparison</p>
                </div>
                <div class="flex items-center space-x-2">
                    <button id="viz-bar" class="px-3 py-1 text-sm bg-primary text-white rounded transition-colors">
                        <i class="fas fa-chart-bar mr-1"></i>Bar Chart
                    </button>
                    <button id="viz-line" class="px-3 py-1 text-sm bg-secondary-200 text-text-secondary rounded hover:bg-secondary-300 transition-colors">
                        <i class="fas fa-chart-line mr-1"></i>Line Chart
                    </button>
                    <button id="viz-heatmap" class="px-3 py-1 text-sm bg-secondary-200 text-text-secondary rounded hover:bg-secondary-300 transition-colors">
                        <i class="fas fa-th mr-1"></i>Heatmap
                    </button>
                </div>
            </div>

            <!-- Chart Container -->
            <div class="h-80 bg-secondary-50 rounded-lg flex items-center justify-center">
                <div id="comparison-chart" class="w-full h-full">
                    <!-- Comparative Bar Chart -->
                    <svg class="w-full h-full" viewBox="0 0 800 300">
                        <defs>
                            <linearGradient id="constructionCompGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" style="stop-color:#3B82F6;stop-opacity:0.8" />
                                <stop offset="100%" style="stop-color:#3B82F6;stop-opacity:0.4" />
                            </linearGradient>
                            <linearGradient id="manufacturingCompGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" style="stop-color:#0EA5E9;stop-opacity:0.8" />
                                <stop offset="100%" style="stop-color:#0EA5E9;stop-opacity:0.4" />
                            </linearGradient>
                        </defs>
                        
                        <!-- Grid Lines -->
                        <g stroke="#E2E8F0" stroke-width="1">
                            <line x1="80" y1="50" x2="720" y2="50"/>
                            <line x1="80" y1="100" x2="720" y2="100"/>
                            <line x1="80" y1="150" x2="720" y2="150"/>
                            <line x1="80" y1="200" x2="720" y2="200"/>
                            <line x1="80" y1="250" x2="720" y2="250"/>
                        </g>
                        
                        <!-- Y-axis labels -->
                        <g fill="#64748B" font-size="12" text-anchor="end">
                            <text x="75" y="55">100%</text>
                            <text x="75" y="105">75%</text>
                            <text x="75" y="155">50%</text>
                            <text x="75" y="205">25%</text>
                            <text x="75" y="255">0%</text>
                        </g>
                        
                        <!-- Grouped Bars -->
                        <!-- Safety Score -->
                        <g>
                            <rect x="120" y="62" width="30" height="188" fill="url(#constructionCompGrad)" rx="2"/>
                            <rect x="155" y="100" width="30" height="150" fill="url(#manufacturingCompGrad)" rx="2"/>
                            <text x="152" y="275" fill="#64748B" font-size="11" text-anchor="middle">Safety Score</text>
                        </g>
                        
                        <!-- Incident Rate -->
                        <g>
                            <rect x="220" y="230" width="30" height="20" fill="url(#constructionCompGrad)" rx="2"/>
                            <rect x="255" y="210" width="30" height="40" fill="url(#manufacturingCompGrad)" rx="2"/>
                            <text x="252" y="275" fill="#64748B" font-size="11" text-anchor="middle">Incident Rate</text>
                        </g>
                        
                        <!-- Observations -->
                        <g>
                            <rect x="320" y="80" width="30" height="170" fill="url(#constructionCompGrad)" rx="2"/>
                            <rect x="355" y="120" width="30" height="130" fill="url(#manufacturingCompGrad)" rx="2"/>
                            <text x="352" y="275" fill="#64748B" font-size="11" text-anchor="middle">Observations</text>
                        </g>
                        
                        <!-- Training -->
                        <g>
                            <rect x="420" y="54" width="30" height="196" fill="url(#constructionCompGrad)" rx="2"/>
                            <rect x="455" y="72" width="30" height="178" fill="url(#manufacturingCompGrad)" rx="2"/>
                            <text x="452" y="275" fill="#64748B" font-size="11" text-anchor="middle">Training</text>
                        </g>
                        
                        <!-- Response Time -->
                        <g>
                            <rect x="520" y="190" width="30" height="60" fill="url(#constructionCompGrad)" rx="2"/>
                            <rect x="555" y="160" width="30" height="90" fill="url(#manufacturingCompGrad)" rx="2"/>
                            <text x="552" y="275" fill="#64748B" font-size="11" text-anchor="middle">Response Time</text>
                        </g>
                        
                        <!-- Legend -->
                        <g>
                            <rect x="600" y="60" width="12" height="12" fill="#3B82F6" rx="2"/>
                            <text x="620" y="70" fill="#64748B" font-size="12">Construction</text>
                            <rect x="600" y="80" width="12" height="12" fill="#0EA5E9" rx="2"/>
                            <text x="620" y="90" fill="#64748B" font-size="12">Manufacturing</text>
                        </g>
                    </svg>
                </div>
            </div>
        </div>

        <!-- Statistical Analysis -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Performance Variance -->
            <div class="card-elevated bg-surface p-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold text-text-primary">Performance Variance</h3>
                    <i class="fas fa-chart-line text-accent text-xl"></i>
                </div>
                <div class="space-y-4">
                    <div class="flex items-center justify-between p-3 bg-success-50 rounded-lg">
                        <span class="text-sm font-medium text-text-primary">Safety Score</span>
                        <div class="text-right">
                            <div class="text-lg font-bold text-success">+6.7%</div>
                            <div class="text-xs text-text-secondary">Construction leads</div>
                        </div>
                    </div>
                    <div class="flex items-center justify-between p-3 bg-error-50 rounded-lg">
                        <span class="text-sm font-medium text-text-primary">Incident Rate</span>
                        <div class="text-right">
                            <div class="text-lg font-bold text-error">+70.8%</div>
                            <div class="text-xs text-text-secondary">Manufacturing higher</div>
                        </div>
                    </div>
                    <div class="flex items-center justify-between p-3 bg-warning-50 rounded-lg">
                        <span class="text-sm font-medium text-text-primary">Response Time</span>
                        <div class="text-right">
                            <div class="text-lg font-bold text-warning">+50.0%</div>
                            <div class="text-xs text-text-secondary">Manufacturing slower</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Risk Assessment -->
            <div class="card-elevated bg-surface p-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold text-text-primary">Risk Assessment</h3>
                    <i class="fas fa-exclamation-triangle text-warning text-xl"></i>
                </div>
                <div class="space-y-4">
                    <div class="flex items-center space-x-3 p-3 bg-error-50 border border-error-100 rounded-lg">
                        <div class="w-8 h-8 bg-error text-white rounded-full flex items-center justify-center">
                            <i class="fas fa-exclamation text-sm"></i>
                        </div>
                        <div class="flex-1">
                            <p class="text-sm font-medium text-text-primary">High Risk Zone</p>
                            <p class="text-xs text-text-secondary">Manufacturing incident rate 70% above benchmark</p>
                        </div>
                    </div>
                    <div class="flex items-center space-x-3 p-3 bg-warning-50 border border-warning-100 rounded-lg">
                        <div class="w-8 h-8 bg-warning text-white rounded-full flex items-center justify-center">
                            <i class="fas fa-triangle-exclamation text-sm"></i>
                        </div>
                        <div class="flex-1">
                            <p class="text-sm font-medium text-text-primary">Attention Required</p>
                            <p class="text-xs text-text-secondary">Response time variance needs improvement</p>
                        </div>
                    </div>
                    <div class="flex items-center space-x-3 p-3 bg-success-50 border border-success-100 rounded-lg">
                        <div class="w-8 h-8 bg-success text-white rounded-full flex items-center justify-center">
                            <i class="fas fa-check text-sm"></i>
                        </div>
                        <div class="flex-1">
                            <p class="text-sm font-medium text-text-primary">Best Practice</p>
                            <p class="text-xs text-text-secondary">Construction training completion exemplary</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Recommendations -->
            <div class="card-elevated bg-surface p-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold text-text-primary">Recommendations</h3>
                    <i class="fas fa-lightbulb text-accent text-xl"></i>
                </div>
                <div class="space-y-4">
                    <div class="p-3 bg-primary-50 border-l-4 border-primary rounded">
                        <p class="text-sm font-medium text-text-primary mb-1">Priority Action</p>
                        <p class="text-xs text-text-secondary">Implement Construction sector safety protocols in Manufacturing</p>
                    </div>
                    <div class="p-3 bg-accent-50 border-l-4 border-accent rounded">
                        <p class="text-sm font-medium text-text-primary mb-1">Process Improvement</p>
                        <p class="text-xs text-text-secondary">Reduce Manufacturing response time through automation</p>
                    </div>
                    <div class="p-3 bg-success-50 border-l-4 border-success rounded">
                        <p class="text-sm font-medium text-text-primary mb-1">Knowledge Transfer</p>
                        <p class="text-xs text-text-secondary">Share Construction training methodologies across sectors</p>
                    </div>
                </div>
                <div class="mt-4 pt-4 border-t border-secondary-200">
                    <button id="generate-action-plan" class="w-full px-4 py-2 bg-primary text-white rounded-button hover:bg-primary-700 transition-colors">
                        <i class="fas fa-download mr-2"></i>
                        Generate Action Plan
                    </button>
                </div>
            </div>
        </div>
    </main>

    <!-- JavaScript for Interactivity -->
    <script>
        // Mobile menu toggle
        document.getElementById('mobile-menu-button').addEventListener('click', function() {
            const mobileMenu = document.getElementById('mobile-menu');
            mobileMenu.classList.toggle('hidden');
        });

        // Function to download a file with specified content and filename
        function downloadFile(content, filename, contentType) {
            // Create a Blob with the content
            const blob = new Blob([content], { type: contentType });
            
            // Create a URL for the Blob
            const url = URL.createObjectURL(blob);
            
            // Create a temporary anchor element
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            
            // Programmatically click the anchor to trigger download
            document.body.appendChild(a);
            a.click();
            
            // Clean up
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Function to collect ALL data from the page
        function collectAllPageData() {
            const timestamp = new Date().toLocaleString();
            const comparisonType = document.getElementById('comparison-type').value;
            const firstEntity = document.getElementById('first-entity').value;
            const secondEntity = document.getElementById('second-entity').value;
            
            // Collect comparison controls data
            const comparisonControls = {
                comparisonType: comparisonType,
                firstEntity: firstEntity,
                secondEntity: secondEntity,
                dateRange: document.querySelector('.form-input').value,
                activeFilters: Array.from(document.querySelectorAll('.filter-chip.active')).map(chip => chip.dataset.filter)
            };

            // Collect construction sector data
            const constructionSector = {
                name: "Construction Sector",
                status: "Active",
                projects: 12,
                officers: 24,
                metrics: {
                    safetyScore: "94.2%",
                    reportsToday: 18,
                    openIncidents: 3,
                    observations: 1247,
                    complianceRate: "94.2%",
                    incidentRate: "2.4 per 1000",
                    nearMissReports: 156,
                    trainingCompletion: "98.5%",
                    avgResponseTime: "12 min"
                },
                trend: "+2.1% improvement (30-day)"
            };

            // Collect manufacturing sector data
            const manufacturingSector = {
                name: "Manufacturing Sector",
                status: "Needs Attention",
                projects: 8,
                officers: 16,
                metrics: {
                    safetyScore: "87.5%",
                    reportsToday: 12,
                    openIncidents: 7,
                    observations: 892,
                    complianceRate: "87.5%",
                    incidentRate: "4.1 per 1000",
                    nearMissReports: 89,
                    trainingCompletion: "91.2%",
                    avgResponseTime: "18 min"
                },
                variances: {
                    safetyScore: "-6.7%",
                    incidentRate: "+70.8%",
                    nearMissReports: "-42.9%",
                    trainingCompletion: "-7.4%",
                    responseTime: "+50.0%"
                },
                trend: "-1.3% decline (30-day)"
            };

            // Collect performance variance data
            const performanceVariance = [
                { metric: "Safety Score", value: "+6.7%", description: "Construction leads" },
                { metric: "Incident Rate", value: "+70.8%", description: "Manufacturing higher" },
                { metric: "Response Time", value: "+50.0%", description: "Manufacturing slower" }
            ];

            // Collect risk assessment data
            const riskAssessment = [
                { 
                    level: "High Risk", 
                    title: "High Risk Zone", 
                    description: "Manufacturing incident rate 70% above benchmark" 
                },
                { 
                    level: "Medium Risk", 
                    title: "Attention Required", 
                    description: "Response time variance needs improvement" 
                },
                { 
                    level: "Low Risk", 
                    title: "Best Practice", 
                    description: "Construction training completion exemplary" 
                }
            ];

            // Collect recommendations data
            const recommendations = [
                {
                    type: "Priority Action",
                    description: "Implement Construction sector safety protocols in Manufacturing"
                },
                {
                    type: "Process Improvement",
                    description: "Reduce Manufacturing response time through automation"
                },
                {
                    type: "Knowledge Transfer",
                    description: "Share Construction training methodologies across sectors"
                }
            ];

            // Collect visualization data
            const visualizationData = {
                currentType: "Bar Chart",
                metricsCompared: ["Safety Score", "Incident Rate", "Observations", "Training", "Response Time"],
                constructionValues: [94.2, 2.4, 1247, 98.5, 12],
                manufacturingValues: [87.5, 4.1, 892, 91.2, 18]
            };

            return {
                timestamp,
                comparisonControls,
                constructionSector,
                manufacturingSector,
                performanceVariance,
                riskAssessment,
                recommendations,
                visualizationData
            };
        }

        // Function to generate comprehensive Excel content
        function generateComprehensiveExcelContent() {
            const data = collectAllPageData();
            
            const csvContent = [
                "COMPREHENSIVE SAFETY COMPARISON ANALYSIS REPORT",
                "===============================================",
                "",
                `Generated: ${data.timestamp}`,
                `Comparison Type: ${data.comparisonControls.comparisonType}`,
                `Entities: ${data.comparisonControls.firstEntity} vs ${data.comparisonControls.secondEntity}`,
                `Date Range: ${data.comparisonControls.dateRange}`,
                `Active Filters: ${data.comparisonControls.activeFilters.join(', ')}`,
                "",
                "",
                "COMPARISON ENTITIES DETAILS",
                "===========================",
                "",
                `${data.constructionSector.name}`,
                `Status: ${data.constructionSector.status}`,
                `Active Projects: ${data.constructionSector.projects}`,
                `Safety Officers: ${data.constructionSector.officers}`,
                "",
                "Key Metrics:",
                `Safety Score: ${data.constructionSector.metrics.safetyScore}`,
                `Reports Today: ${data.constructionSector.metrics.reportsToday}`,
                `Open Incidents: ${data.constructionSector.metrics.openIncidents}`,
                `Observations: ${data.constructionSector.metrics.observations}`,
                `Compliance Rate: ${data.constructionSector.metrics.complianceRate}`,
                `Incident Rate: ${data.constructionSector.metrics.incidentRate}`,
                `Near Miss Reports: ${data.constructionSector.metrics.nearMissReports}`,
                `Training Completion: ${data.constructionSector.metrics.trainingCompletion}`,
                `Avg Response Time: ${data.constructionSector.metrics.avgResponseTime}`,
                `Trend: ${data.constructionSector.trend}`,
                "",
                "",
                `${data.manufacturingSector.name}`,
                `Status: ${data.manufacturingSector.status}`,
                `Active Projects: ${data.manufacturingSector.projects}`,
                `Safety Officers: ${data.manufacturingSector.officers}`,
                "",
                "Key Metrics:",
                `Safety Score: ${data.manufacturingSector.metrics.safetyScore}`,
                `Reports Today: ${data.manufacturingSector.metrics.reportsToday}`,
                `Open Incidents: ${data.manufacturingSector.metrics.openIncidents}`,
                `Observations: ${data.manufacturingSector.metrics.observations}`,
                `Compliance Rate: ${data.manufacturingSector.metrics.complianceRate}`,
                `Incident Rate: ${data.manufacturingSector.metrics.incidentRate}`,
                `Near Miss Reports: ${data.manufacturingSector.metrics.nearMissReports}`,
                `Training Completion: ${data.manufacturingSector.metrics.trainingCompletion}`,
                `Avg Response Time: ${data.manufacturingSector.metrics.avgResponseTime}`,
                `Trend: ${data.manufacturingSector.trend}`,
                "",
                "Variances vs Construction:",
                `Safety Score: ${data.manufacturingSector.variances.safetyScore}`,
                `Incident Rate: ${data.manufacturingSector.variances.incidentRate}`,
                `Near Miss Reports: ${data.manufacturingSector.variances.nearMissReports}`,
                `Training Completion: ${data.manufacturingSector.variances.trainingCompletion}`,
                `Response Time: ${data.manufacturingSector.variances.responseTime}`,
                "",
                "",
                "PERFORMANCE VARIANCE ANALYSIS",
                "=============================",
                "",
                ...data.performanceVariance.map(item => 
                    `${item.metric}: ${item.value} - ${item.description}`
                ),
                "",
                "",
                "RISK ASSESSMENT",
                "===============",
                "",
                ...data.riskAssessment.map(item => 
                    `${item.level} RISK: ${item.title} - ${item.description}`
                ),
                "",
                "",
                "RECOMMENDATIONS & ACTION ITEMS",
                "==============================",
                "",
                ...data.recommendations.map(item => 
                    `${item.type}: ${item.description}`
                ),
                "",
                "",
                "VISUALIZATION DATA",
                "==================",
                "",
                `Current Visualization: ${data.visualizationData.currentType}`,
                "Metrics Compared: " + data.visualizationData.metricsCompared.join(', '),
                "",
                "Construction Sector Values:",
                ...data.visualizationData.constructionValues.map((value, index) => 
                    `${data.visualizationData.metricsCompared[index]}: ${value}`
                ),
                "",
                "Manufacturing Sector Values:",
                ...data.visualizationData.manufacturingValues.map((value, index) => 
                    `${data.visualizationData.metricsCompared[index]}: ${value}`
                ),
                "",
                "",
                "EXECUTIVE SUMMARY",
                "================",
                "",
                "The comparative analysis reveals significant performance differences between Construction and Manufacturing sectors.",
                "Construction sector demonstrates superior safety performance with a 94.2% safety score and lower incident rates.",
                "Manufacturing sector requires immediate attention with a 70.8% higher incident rate and 50% slower response times.",
                "Key recommendations include implementing Construction safety protocols in Manufacturing and improving response time automation.",
                "",
                "",
                "Report generated by HO Safety Management System - Comprehensive Analysis Module"
            ].join('\n');
            
            return csvContent;
        }

        // Function to generate comprehensive PDF content
        function generateComprehensivePDFContent() {
            const data = collectAllPageData();
            
            const pdfContent = [
                "COMPREHENSIVE SAFETY COMPARISON ANALYSIS REPORT",
                "===============================================",
                "",
                `Generated: ${data.timestamp}`,
                "",
                "COMPARISON OVERVIEW",
                "-------------------",
                `Comparison Type: ${data.comparisonControls.comparisonType}`,
                `Entities Compared: ${data.comparisonControls.firstEntity} vs ${data.comparisonControls.secondEntity}`,
                `Analysis Period: ${data.comparisonControls.dateRange}`,
                "",
                "",
                "DETAILED SECTOR ANALYSIS",
                "------------------------",
                "",
                `SECTOR 1: ${data.constructionSector.name.toUpperCase()}`,
                "=================================",
                `Status: ${data.constructionSector.status}`,
                `Active Projects: ${data.constructionSector.projects}`,
                `Safety Officers: ${data.constructionSector.officers}`,
                "",
                "PERFORMANCE METRICS:",
                `• Safety Score: ${data.constructionSector.metrics.safetyScore}`,
                `• Daily Reports: ${data.constructionSector.metrics.reportsToday}`,
                `• Open Incidents: ${data.constructionSector.metrics.openIncidents}`,
                `• Safety Observations: ${data.constructionSector.metrics.observations}`,
                `• Compliance Rate: ${data.constructionSector.metrics.complianceRate}`,
                `• Incident Rate: ${data.constructionSector.metrics.incidentRate}`,
                `• Near Miss Reports: ${data.constructionSector.metrics.nearMissReports}`,
                `• Training Completion: ${data.constructionSector.metrics.trainingCompletion}`,
                `• Average Response Time: ${data.constructionSector.metrics.avgResponseTime}`,
                `• Performance Trend: ${data.constructionSector.trend}`,
                "",
                "",
                `SECTOR 2: ${data.manufacturingSector.name.toUpperCase()}`,
                "===================================",
                `Status: ${data.manufacturingSector.status}`,
                `Active Projects: ${data.manufacturingSector.projects}`,
                `Safety Officers: ${data.manufacturingSector.officers}`,
                "",
                "PERFORMANCE METRICS:",
                `• Safety Score: ${data.manufacturingSector.metrics.safetyScore}`,
                `• Daily Reports: ${data.manufacturingSector.metrics.reportsToday}`,
                `• Open Incidents: ${data.manufacturingSector.metrics.openIncidents}`,
                `• Safety Observations: ${data.manufacturingSector.metrics.observations}`,
                `• Compliance Rate: ${data.manufacturingSector.metrics.complianceRate}`,
                `• Incident Rate: ${data.manufacturingSector.metrics.incidentRate}`,
                `• Near Miss Reports: ${data.manufacturingSector.metrics.nearMissReports}`,
                `• Training Completion: ${data.manufacturingSector.metrics.trainingCompletion}`,
                `• Average Response Time: ${data.manufacturingSector.metrics.avgResponseTime}`,
                `• Performance Trend: ${data.manufacturingSector.trend}`,
                "",
                "PERFORMANCE VARIANCES (vs Construction):",
                `• Safety Score: ${data.manufacturingSector.variances.safetyScore}`,
                `• Incident Rate: ${data.manufacturingSector.variances.incidentRate}`,
                `• Near Miss Reports: ${data.manufacturingSector.variances.nearMissReports}`,
                `• Training Completion: ${data.manufacturingSector.variances.trainingCompletion}`,
                `• Response Time: ${data.manufacturingSector.variances.responseTime}`,
                "",
                "",
                "PERFORMANCE VARIANCE ANALYSIS",
                "-----------------------------",
                "",
                ...data.performanceVariance.map(item => 
                    `• ${item.metric}: ${item.value} - ${item.description}`
                ),
                "",
                "",
                "RISK ASSESSMENT SUMMARY",
                "-----------------------",
                "",
                ...data.riskAssessment.map(item => 
                    `[${item.level.toUpperCase()}] ${item.title}: ${item.description}`
                ),
                "",
                "",
                "STRATEGIC RECOMMENDATIONS",
                "-------------------------",
                "",
                ...data.recommendations.map((item, index) => 
                    `${index + 1}. ${item.type.toUpperCase()}: ${item.description}`
                ),
                "",
                "",
                "VISUALIZATION INSIGHTS",
                "---------------------",
                "",
                `Current Visualization: ${data.visualizationData.currentType}`,
                "Metrics Compared:",
                ...data.visualizationData.metricsCompared.map(metric => `  • ${metric}`),
                "",
                "Key Insights from Data Visualization:",
                "• Construction leads in safety score by 6.7 percentage points",
                "• Manufacturing has 70.8% higher incident rate",
                "• Construction conducts 39.8% more safety observations",
                "• Training completion gap of 7.3 percentage points",
                "• Response time 50% slower in Manufacturing sector",
                "",
                "",
                "EXECUTIVE SUMMARY & NEXT STEPS",
                "------------------------------",
                "",
                "KEY FINDINGS:",
                "• Construction sector demonstrates exemplary safety performance",
                "• Manufacturing sector requires immediate intervention",
                "• Significant opportunity for knowledge transfer between sectors",
                "• Response time optimization needed in Manufacturing",
                "",
                "PRIORITY ACTIONS:",
                "1. Conduct safety protocol audit in Manufacturing sector",
                "2. Implement Construction's training methodologies across organization",
                "3. Deploy automated response systems in Manufacturing facilities",
                "4. Establish cross-sector safety committee",
                "5. Set up weekly progress tracking for improvement initiatives",
                "",
                "EXPECTED OUTCOMES:",
                "• 30% reduction in Manufacturing incident rate within 60 days",
                "• 25% improvement in Manufacturing response time",
                "• 5% overall safety score improvement across organization",
                "• Enhanced safety culture and knowledge sharing",
                "",
                "",
                "This comprehensive report was generated by",
                "HO Safety Management System - Advanced Analytics Division",
                `Report ID: SAF-${Date.now()}`,
                "Confidential - For Internal Use Only"
            ].join('\n');
            
            return pdfContent;
        }

        // Export buttons functionality - Now downloads comprehensive data
        document.getElementById('export-excel-btn').addEventListener('click', function() {
            console.log('Exporting comprehensive data to Excel...');
            // Add loading state
            const originalText = this.innerHTML;
            this.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Exporting...';
            this.disabled = true;
            
            // Generate and download comprehensive Excel file
            setTimeout(() => {
                const excelContent = generateComprehensiveExcelContent();
                downloadFile(excelContent, 'comprehensive_safety_comparison_analysis.xlsx', 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
                
                this.innerHTML = originalText;
                this.disabled = false;
                
                // Show success notification
                showNotification('Comprehensive Excel report downloaded successfully!', 'success');
            }, 1500);
        });

        document.getElementById('export-pdf-btn').addEventListener('click', function() {
            console.log('Exporting comprehensive data to PDF...');
            // Add loading state
            const originalText = this.innerHTML;
            this.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Exporting...';
            this.disabled = true;
            
            // Generate and download comprehensive PDF file
            setTimeout(() => {
                const pdfContent = generateComprehensivePDFContent();
                downloadFile(pdfContent, 'comprehensive_safety_comparison_analysis.pdf', 'application/pdf');
                
                this.innerHTML = originalText;
                this.disabled = false;
                
                // Show success notification
                showNotification('Comprehensive PDF report downloaded successfully!', 'success');
            }, 1500);
        });

        // Generate Action Plan button
        document.getElementById('generate-action-plan').addEventListener('click', function() {
            console.log('Generating comprehensive action plan...');
            // Add loading state
            const originalText = this.innerHTML;
            this.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Generating...';
            this.disabled = true;
            
            // Generate and download action plan
            setTimeout(() => {
                const data = collectAllPageData();
                const actionPlanContent = generateComprehensivePDFContent(); // Reuse PDF content for action plan
                downloadFile(actionPlanContent, 'safety_improvement_action_plan.pdf', 'application/pdf');
                
                this.innerHTML = originalText;
                this.disabled = false;
                
                // Show success notification
                showNotification('Comprehensive action plan downloaded successfully!', 'success');
            }, 2000);
        });

        // Function to show notifications
        function showNotification(message, type = 'info') {
            // Create notification element
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 p-4 rounded-lg shadow-lg z-50 ${
                type === 'success' ? 'bg-success text-white' : 
                type === 'error' ? 'bg-error text-white' : 
                'bg-primary text-white'
            }`;
            notification.innerHTML = `
                <div class="flex items-center">
                    <i class="fas ${
                        type === 'success' ? 'fa-check-circle' : 
                        type === 'error' ? 'fa-exclamation-circle' : 
                        'fa-info-circle'
                    } mr-2"></i>
                    <span>${message}</span>
                </div>
            `;
            
            // Add to page
            document.body.appendChild(notification);
            
            // Remove after 3 seconds
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            }, 3000);
        }

        // Comparison type change handler
        document.getElementById('comparison-type').addEventListener('change', function() {
            const type = this.value;
            const firstEntity = document.getElementById('first-entity');
            const secondEntity = document.getElementById('second-entity');
            
            // Update dropdown options based on comparison type
            if (type === 'project') {
                firstEntity.innerHTML = `
                    <option value="metro-bridge">Metro Bridge Project</option>
                    <option value="steel-plant">Steel Plant Alpha</option>
                    <option value="solar-farm">Solar Farm Delta</option>
                    <option value="highway-ext">Highway Extension</option>
                `;
                secondEntity.innerHTML = `
                    <option value="steel-plant">Steel Plant Alpha</option>
                    <option value="metro-bridge">Metro Bridge Project</option>
                    <option value="solar-farm">Solar Farm Delta</option>
                    <option value="highway-ext">Highway Extension</option>
                `;
            } else if (type === 'officer') {
                firstEntity.innerHTML = `
                    <option value="sarah-johnson">Sarah Johnson</option>
                    <option value="mike-chen">Mike Chen</option>
                    <option value="emily-davis">Emily Davis</option>
                    <option value="james-wilson">James Wilson</option>
                `;
                secondEntity.innerHTML = `
                    <option value="mike-chen">Mike Chen</option>
                    <option value="sarah-johnson">Sarah Johnson</option>
                    <option value="emily-davis">Emily Davis</option>
                    <option value="james-wilson">James Wilson</option>
                `;
            } else {
                // Reset to sectors
                firstEntity.innerHTML = `
                    <option value="construction">Construction Sector</option>
                    <option value="manufacturing">Manufacturing Sector</option>
                    <option value="energy">Energy Sector</option>
                    <option value="infrastructure">Infrastructure Sector</option>
                `;
                secondEntity.innerHTML = `
                    <option value="manufacturing">Manufacturing Sector</option>
                    <option value="construction">Construction Sector</option>
                    <option value="energy">Energy Sector</option>
                    <option value="infrastructure">Infrastructure Sector</option>
                `;
            }
        });

        // Filter chips functionality
        document.querySelectorAll('.filter-chip').forEach(chip => {
            chip.addEventListener('click', function() {
                document.querySelectorAll('.filter-chip').forEach(c => c.classList.remove('active'));
                this.classList.add('active');
                console.log('Filter applied:', this.dataset.filter);
            });
        });

        // Visualization toggle functionality
        const vizButtons = document.querySelectorAll('[id^="viz-"]');
        vizButtons.forEach(button => {
            button.addEventListener('click', function() {
                vizButtons.forEach(btn => {
                    btn.classList.remove('bg-primary', 'text-white');
                    btn.classList.add('bg-secondary-200', 'text-text-secondary');
                });
                
                this.classList.remove('bg-secondary-200', 'text-text-secondary');
                this.classList.add('bg-primary', 'text-white');
                
                console.log('Visualization changed to:', this.id.replace('viz-', ''));
            });
        });

        // Apply comparison functionality
        document.getElementById('apply-comparison').addEventListener('click', function() {
            const comparisonType = document.getElementById('comparison-type').value;
            const firstEntity = document.getElementById('first-entity').value;
            const secondEntity = document.getElementById('second-entity').value;
            
            console.log('Applying comparison:', {
                type: comparisonType,
                first: firstEntity,
                second: secondEntity
            });
            
            // Add loading state
            this.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Updating...';
            this.disabled = true;
            
            // Simulate API call
            setTimeout(() => {
                this.innerHTML = '<i class="fas fa-sync-alt mr-2"></i>Apply Comparison';
                this.disabled = false;
                
                // Show notification
                showNotification('Comparison updated successfully!', 'success');
            }, 2000);
        });

        // Auto-refresh timestamp
        function updateTimestamp() {
            const timestamp = document.getElementById('last-updated');
            if (timestamp) {
                const now = new Date();
                const timeString = now.toLocaleString('en-US', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric',
                    hour: 'numeric',
                    minute: '2-digit',
                    hour12: true
                });
                timestamp.textContent = `Last updated: ${timeString}`;
            }
        }

        // Initialize timestamp and set interval
        updateTimestamp();
        setInterval(updateTimestamp, 30000);
    </script>
<script id="dhws-dataInjector" src="../public/dhws-data-injector.js"></script>
</body>
</html>